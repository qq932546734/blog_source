---
title: 线性代数
date: 2019-09-24 08:56:47
tags:
---

## 矩阵与方程组
***

### 严格三角形的方程组
若方程组中，第k个方程的前k-1个变量的系数均为零，且$x_k(k=1,..., n)$的系数不为零，则称该方程组为严格三角形的。

### 增广矩阵
在方程组的系数矩阵的右侧添加一列方程组的右端项，得到增广矩阵

### 初等行运算
1. 交换两行
2. 以非零实数乘于某行
3. 将某行替换成它与其他某行的倍数的和

### 行阶梯形矩阵
若一个矩阵满足：
1. 每一个非零行中的第一个非零元为1；
2. 第$k$行的元不全为零，第$k+1$行首变量之前零的个数多于第k行首变量之前零的个数；
3. 所有元素均为零的行必在不全为零的行之后。

### 超定方程组
若一个线性方程组中方程的个数多于未知量的个数，称之为超定方程组。通常为不相容的。

### 亚定方程组
若一个线性方程组中方程的个数少于未知量的个数，称之为亚定方程组。通常为相容的（存在不相容的情况），且如果相容的话，必有无穷组解。

### 行最简形矩阵
矩阵是行阶梯形的，且每一行的第一个非零元是该列唯一的非零行。


### 求解线性方程组的方法
* 回代法
* 高斯消元法：利用初等行运算将线性方程组的增广矩阵化为**行阶梯形矩阵**
* 高斯-若尔当消元法：采用初等行运算将线性方程组的增广矩阵化成**行最简形**

### 齐次方程组
<s>右端项全为零的线性方程组。齐次方程组必有平凡解，即所有变量都为零。若齐次方程组为亚定方程组，即方程个数小于变量的个数，该方程组必有非平凡解。</s>

### 线性方程组相容
一个线性方程组 $A\textbf{x}=\textbf{b}$ 相容的充要条件是向量$b$可写成矩阵A列向量的一个线性组合。

### 对称矩阵
若满足$A=A^T$,为对称矩阵

### 矩阵的逆、非奇异矩阵
若存在一个矩阵$B$使得$AB=BA=I$, 则称$n\times n$矩阵A为可逆的，也为非奇异的。若矩阵不存在乘法逆元，则称之为奇异的。

> 只有方阵才有逆，才有奇异性这么一说

### 矩阵运算
1. $(AB)^T = {B^T}{A^T}$
2. $(AB)^{-1} = B^{-1}A^{-1}$(前提条件是AB都是方阵，且都可逆)


> 1可以通过矩阵的元素$a_{ij}$进行证明；2可以通过$(AB)

### 初等矩阵
从单位矩阵经过一次初等行运算，得到的矩阵为初等矩阵。初等矩阵分为三类：
1. 交换单位矩阵的两行，逆运算为本身
2. 单位矩阵的某一行乘以一个非零常数a，逆运算等于乘以1/a
3. 单位矩阵的某一行的倍数加到另外一行，逆运算等于减去该倍数  

矩阵$A$左乘初等矩阵$E_1$(即$E_1*A$)等于将矩阵$A$按照初等矩阵$E_1$的行变换进行行变换。右乘初等矩阵等于按照初等矩阵的列变换进行相应的列变换。
$$
\begin{align}
E_3 = \begin{bmatrix} 1 & 0 & 3\\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1\end{bmatrix} \\\\
E_3A = \begin{bmatrix} a_{11}+3a_{31} & a_{12}+3a_{32} & a_{13}+3a_{33} \\\\
a_{21} & a_{22} & a_{23} \\\\
a_{31} & a_{32} & a_{33} \end{bmatrix} \\\\
AE_3 = \begin{bmatrix} a_{11} & a_{12} & 3a_{11} + a_{13} \\\\
a_{21} & a_{22} & 3a_{21} + a_{23} \\\\
a_{31} & a_{32} & 3a_{31}+a_{33} \end{bmatrix}
\end{align}
$$

### 行等价
若存在一个有限初等矩阵序列$E_1, E_2, E_3, ..., E_k$， 使得 $B = E_kE_{k-1}...E_1A$，则称A和B是行等价的。

### 非奇异矩阵的等价条件
1. $A$是非奇异的
2. $Ax=0$仅有平凡解$0$
3. $A$与$I$行等价

### 矩阵求逆
将矩阵A与单位矩阵构成增广矩阵，然后用高斯消元法将A化成单位矩阵，右侧的结果便是$A^{-1}$

### LU分解、三角形分解
如果一个$n*n$矩阵A可以仅利用初等矩阵运算三（某一行的倍数加到另一行）化简为严格的上三角形的，则A有一个$LU$分解。$U$为严格的上三角形矩阵。
$L$为单位下三角矩阵（对角元素为1），且当$i>j$，$L_{ij}$为消元过程中第$i$行减去第$j$行的倍数。

### 外积？？？
不同于内积$x^Ty$，外积等于$xy^T$
$$
xy^T = \begin{bmatrix} x_1 \\\\ x_2 \\\\ \vdots \\\\ x_n \\\\ \end{bmatrix}
(y_1, y_2, ..., y_n)
$$

### 向量积
给定$R^3$中的两个向量$x$和$y$，可以定义第三个向量，即向量积，记为$x\times y$:
$$
x \times y =  \left\lvert
\begin{matrix} e_1 & e_2 & e_3 \\\\
x_1 & x_2 & x_3 \\\\
y_1 & y_2 & y_3 \\\\  \end{matrix}
\right\rvert
$$
将以上行列式第一行换成第二行或者第三行的元素，根据行列式的性质，存在两行相等的行列式为0，故
$$
x^T(x\times y) = y^T(x\times y) = 0
$$
内积为0的两向量正交，故$(x\times y)$跟$x$和$y$都正交。
向量积的欧几里得长度等于
$$
\left\lVert x\times y \right\rVert = \left\lVert x \right\rVert \left\lVert y \right\rVert \sin\theta
$$

## 行列式
***
### 子式和余子式
令$A=(a_{ij})$为一$n*n$矩阵，并用$M_{ij}$来表示删除A中包含$a_{ij}$的行和列得到的$(n-1)(n-1)$矩阵。矩阵$M_{ij}$的行列式为$a_{ij}$的子式。
$a_{ij}$的余子式$A_{ij}$为
$$ A_{ij} = (-1)^{i+j}det(M_{ij})$$


### 行列式
$$
det(A) = \begin{cases}
a_{11} & \text{当n=1时} \\\\
a_{i1}A_{i1}+a_{i2}A_{i2} + \cdots + a_{in}A_{in} & \text{当n > 1时，取第i行} \\\\
a_{1j}A_{1j} + a_{2j}A_{2j} + \cdots + a_{nj}A_{nj} & \text{当n > 1时，取第j列} \\\\ 
\end{cases}
$$
矩阵行列式等于矩阵转置的行列式
$$
det(A) = det(A^T)
$$
行列式性质
1. 三角矩阵的行列式等于对角元素的乘积
2. 若矩阵有一行或一列全为0，则$det(A)=0$
3. 若矩阵有两行或两列相等，则$det(A)=0$


## 向量空间

***

### 常见的向量空间

1. 欧几里得向量空间（$R^n$），相同长度和相同方向的向量是相同的；
2. 向量空间$R^{m*n}$，矩阵空间
3. 定义在某个区间内的实值连续函数空间，$C[a,b]$，全集为一函数集合
4. 定义在某个区间内的n阶实值连续可导函数空间，$C^n[a,b]$
5. 多项式向量空间$P_n$，表示次数小于n的所有多项式集合

### 矩阵的零空间
令$A$为一$m*n$矩阵，矩阵的零空间表示为$N(A)$
$$ N(A) = \lbrace x \in R^n | Ax=0 \rbrace $$

### 线性组合和张成
令$v_1, v_2, v_3, \cdots, v_n$为向量空间$V$中的向量，则$a_1v_1 + a_2v_2+\cdots+a_nv_n$称为向量$v_1, v_2, v_3, \cdots, v_n$的线性组合。它们构成的集合称为$v_1, v_2, v_3, \cdots, v_n$的张成，记为$Span(v_1,\cdots,v_n)$.
$Span(v_1,\cdots, v_n)$是V的一个子空间。若$Span(v_1,\cdots, v_n) = V$，我们说向量$v_1,\cdots, v_n$张成向量V，${v_1,\cdots, v_n}$是V的一个张集。

### 相容线性方程组的解集
若线性方程组$Ax=b$是相容的，$x_0$为它的一个特解，则向量$y$也为其解的充要条件为$y=x_0+z$，其中$z \in N(A)$.
由此我们可以推出求解所有解集的方法：先求出齐次方程的解，然后求一个特解$x_0$，解集即为：$x_0 + a_1z_1 + a_2z_2 + \cdots + a_nz_n$，其中，$z\in N(A)$
> 令$x_0$为方程组$Ax=b$的一个特解，若$x_1$为方程组的另一个解，则$Ax_1 - Ax_0 = 0$， $A(x_1-x_0)=0$，进而可推出，$x_1-x_0$在A的零空间内，$x_1=x_0+z, z \in N(A)$。


### 向量线性相关的充要条件
令$x_1, x_2, \cdots, x_n$ 为$R^n$中的n个向量，并令$X=(x_1, x_2, \cdots, x_n)$.向量$x_1, x_2, \cdots, x_n$线性相关的充要条件是$X$为奇异的。
方程$c_1x_1+c_2x_2 + \cdots + c_nx_n = 0$ 可以写成$Xc=0$，若X非奇异，则X存在逆$X^{-1}$，$Xc=0$无非平凡解，即不存在不全为0的$c_1, c_2, \cdots, c_n$，使得该方程成立，表明$x_1, x_2, \cdots, x_n$线性无关。
方程$c_1x_1+c_2x_2 + \cdots + c_kx_k = 0$ 中，若k不等于n，即构造的$X$不是方阵，此时不能用X是否奇异来判断线性相关性；此时判别的标准是--$X$的行阶梯型含有自由变量则线性相关。行阶梯型有自由变量表明方程组有非平凡解。


### 基
当且仅当向量空间$V$中的向量$v_1, v_2, \cdots, v_n$ 满足$v_1, v_2, \cdots, v_n$ 线性无关；$v_1, v_2, \cdots, v_n$ 张成$V$：时（即$Span(v_1, v_2, \cdots, v_n) = V$)，称它们是向量空间$V$的基。

若向量空间$V$的一个张集为${v_1, v_2, \cdots, v_n}$，则若$m>n$，$V$中任何m个向量必线性相关。

若${v_1, v_2, \cdots, v_n}$和${u_1, u_2, \cdots, u_n}$均为向量空间$V$的基，则$n=m$

### 维数、维度
令$V$为一向量空间，若其一组基含有n个向量，我们称$V$的维数为n。

### 标准基
$R^n$的标准基是${e_1, e_2, \cdots, e_n}$，$P_n$的标准基是${1, x, x^2, \cdots, x^n}$。标准基之所以为标准基，是因为其最为自然地张成对应的向量空间。

### 普通基和标准基之间的转换
令$E=[v_1, v_2, \cdots, v_n]$为向量空间$V$的一组有序基，转换矩阵$S=(v_1, v_2, \cdots, v_n)$, 从E转换到标准基的转换矩阵为S，从标准基转换到E的转换矩阵为$S^{-1}$

### 普通基之间的转换
令$E=[v_1, v_2, \cdots, v_n]$和$F=[w_1, w_2, \cdots, w_n]$为向量空间$V$的两组有序基，同时令$U=(v_1, v_2, \cdots, v_n)$, $V=(w_1, w_2, \cdots, w_n)$，则从E到F的转换矩阵为$V^{-1}U$，从F到E的转换矩阵为$U^{-1}V$。
普通基之间的转换可以看成两步：先从普通基转换成标准基，再从标准基转换成普通基。

### 行空间和列空间
矩阵的行向量张成的空间称为矩阵的行空间，同理对应到列空间。
两个行等价的矩阵有相同的行空间。令$A,B$为两行等价矩阵，B可由A经过若干次初等行变换获得，故B的所有行向量都可以表示成A的所有行向量的线性组合，因此B的所有行向量张成的向量空间 $$Span(b_1, \cdots, b_n) = c_1b_1 + \cdots + c_nb_n = d_1a_1+ \cdots + d_na_n = Span(a_1, \cdots, a_n)$$，即等于A的所有行向量张成的空间。

### 秩（rank）
A的行空间的维数称为矩阵A的秩。求解矩阵秩可以将其化成行阶梯型。
秩、零度（矩阵零空间的维度）、行阶梯型自由变量的个数及首变量个数满足：$A$化成行阶梯型$U$，$Ux=0$的首变量个数为$A$的行空间和列空间的秩，自由变量的个数等于零空间的维度。
首变量和自由变量的个数，取决于列向量是否线性相关：若列向量线性无关，则自由变量为0。

### 线性方程组
线性方程组$Ax=b$相容的充要条件是b在A的列空间中。
> $Ax$可以是A的列向量以x为系数张成的空间  

令A为$m \times n$矩阵，当且仅当A的列向量张成$R^m$时，对每一个$b \in R^m$，线性方程组$Ax=b$是相容的
> A的列向量张成$R^m$，等价于$n >= m$

当且仅当A的列向量线性无关时，对每一个$b \in R^m$，方程组$Ax=b$至多有一个解。
> 方程组存在自由变量时，有多解。当A的列向量线性相关的时候，存在自由变量；线性无关时，不存在自由变量，方程至多有一个解。


## 线性变换
***

### 线性变换的定义
一个将向量空间$V$映射到向量空间$W$的映射$L$，如果对所有的$v_1, v_2 \in V$以及所有的标量$\alpha$和$\beta$，满足以下条件，则其为线性变换：
$$ L(\alpha v_1+ \beta v_2) = \alpha L(v_1) + \beta L(v_2) $$

> 以上条件等价于$L(v_1+v_2) = L(v_1) + L(v_2)$ 和 $L(\alpha v) = \alpha L(v)$

若向量空间$V$和$W$相同，那么$L: V \rightarrow V$称为$V$上的线性算子。

### 象与核
令$L: V \rightarrow W$为一线性变换，$L$的核记为$ker(L)$, $ker(L) = {v\in V | L(v)=0_w}$
> 核对应为使得经过线性变换之后为零向量的V的子空间

令S为V的一个子空间，S的象记为$L(S)$，即对所有的$v \in S$, $L(v)$构成的集合。

### 线性变换的矩阵表示
令$L$为一从$R^n$到$R^m$的线性变换，则存在一个$m \times n$的矩阵A，使得对于每一个$x \in R^n$, 有$L(x) = Ax$.
> 
$$
L(x) = L(x_1e_1 + \cdots + x_ne_n) = x_1L(e_1) + \cdots + x_nL(e_n)
\\\\ = (L(e_1), L(e_2), \cdots, L(e_n))
\begin{bmatrix} x_1 \\\\ x_2 \\\\ \vdots \\\\ x_n \\\\ \end{bmatrix}
$$

令$E=[u_1, u_2, \cdots, u_n], F=[b_1, \cdots, b_m]$分别为$R^n$和$R^m$的有序基，若$L: R^n \rightarrow R^m$为一线性变换，且A为L相应于E和F的表示矩阵，则
$$ a_j = B^{-1}L(u_j), j=1, \cdots, n$$
> 从E到F的线性转换，对于E来说，不论E采用的是标准基($e_1, \cdots, e_n$)还是普通基，$L(v) = L(a_1u_1 + \cdots + a_nu_n) = a_1L(u_1) + \cdots + a_nL(u_n)$，经$A=(L(u_1), \cdots, L(u_n))$转换之后，$v$都转换成了F的向量空间中的向量，且是用标准基表示的。若F不是标准基，则需要进行一次坐标转换，从标准基坐标，转换成普通基坐标。此次基变换只是一次坐标变换，即向量的实际空间位置是不变的，变化的是其表示方式，即其在普通基中的坐标。

### 齐次坐标系
> 前面我们看到，所有的线性变换都可以表示为三类的组合：缩放，旋转，关于某轴对称。但平移不是线性变换。为了让平移也能用线性变换类似的方式表示，引入了齐次坐标。

$R^2$中的平移，需要调整两方面。首先是点的表示，
$$ \begin{bmatrix} x_1 \\\\ x_2 \end{bmatrix} \rightarrow \begin{bmatrix} x_1 \\\\ x_2 \\\\ 1 \end{bmatrix} $$
其次是转换矩阵A，若平移向量为$a = (6, 2)^T$，则转换矩阵为
$$ \begin{bmatrix} 1 & 0 \\\\ 0 & 1 \end{bmatrix} \rightarrow \begin{bmatrix} 1 & 0 &  6 \\\\ 0 & 1 & 2 \\\\ 0 & 0 & 1 \end{bmatrix} $$

> 将单位矩阵的最后一行和最后一列添加到$2 \times 2$矩阵，然后将平移向量替换最后一列的前两个元素 

### 相似性
> 线性变换的表示矩阵A会因基的选择而发生变化，若$A$和$B$都表示同一个线性变换对应于不同的基的线性转换，我们称$A$和$B$相似。

令$E=[v_1, v_2, \cdots, v_n], F= [w_1, w_2, \cdots, w_n]$为向量空间$V$的两个有序基，$L$为$V$上的线性算子。令$S$为$F$到$E$的转移矩阵。若$A$为$L$相应于$E$的表示矩阵，$B$为$L$相应于$F$的表示矩阵，则$B=S^{-1}AS$.
> 以上等式可以这样理解：B的线性变换矩阵等同于，首先将B转换所对应的坐标，转移到A转换所对应的坐标中，即乘以S。得到的是相对于E的坐标，此时用A矩阵进行线性转换，得到的是转换之后在A对应的坐标中的表示；最后再转移到B对应的坐标中的表示，即乘以$S^{-1}$

> NOTE: 转移矩阵和转换矩阵
转移矩阵是基变换的表示矩阵，可以理解为将同一个向量从一个有序基坐标中，转移到另一个有序基坐标，坐标发生了变化，但向量本身没有发生改变；
转换矩阵是从一个向量转换到另外一个向量的表示矩阵，向量本身发生了变化。

> 相似性的意义在于同一个线性变换可以用不同的转换矩阵表示，如果能找到一个简单的转换矩阵，如对角矩阵，转换运算会十分方便。因此，采用不同的有序基可以简化转换矩阵，从而简化运算。

## 正交性

***

### 内积空间
定义了内积的向量空间为内积空间。两个向量的内积（标量积）为一个实数，等于
$$ x^Ty = x_1y_1 + \cdots + x_ny_n $$

若$x^Ty=0$, 则向量 $x$ 和向量 $y$ 正交，记为$x \bot y$

### 欧几里得长度
$$  \left\lVert x \right\rVert = (x^Tx)^{1/2} = \sqrt {x_1^2 + x_2^2 + x_3^2} $$
向量x和y的距离定义为数值$\left\lVert x-y \right\rVert$
非零向量$x, y$的夹角为$\theta$，则
$$x^Ty = \left\lVert x \right\rVert \left\lVert y \right\rVert \cos\theta $$
> 可通过余弦定理证明

对于向量x和y，其单位向量分别为
$$
u = \frac{x}{\left\lVert x \right\rVert} \\\\
v = \frac{y}{\left\lVert y \right\rVert}  \\\\
\cos\theta = \frac{x^Ty}{||x|| ||y||} = u^Tv
$$
### 标量投影和向量投影
标量投影指的是向量x在向量y上投影的标量长度，等于x的欧几里得长度乘以$\cos\theta$
$$
a = \frac{x^Ty}{||y||}
$$
向量投影指的是向量x在向量y上的分量，是一个向量，其大小等于标量投影，其方向为y的单位向量
$$
p = au = a \frac{y}{||y||} = \frac{x^Ty}{y^Ty} y
$$
### 法向量
若$N=(a, b, c)^T$为一非零向量，$P_0=(x_0, y_0, z_0)$为一定点，使得$P_0 P$和$N$正交的点$P$的集合构成一个过$P_0$的三维空间中的平面$\pi$。向量$N$和平面$\pi$相互垂直，向量$N$称为平面$\pi$的法向量。此时,向量$P_0P$和向量$N$的内积为0，因此有
$$
a(x-x_0) + b(y-y_0) + c(z-z_0) = 0
$$
> 以上为垂直于N且经过$P_0$的面的平面方程。

### 平面方程，点到面的距离
1. 知道法向量和一个定点，直接利用向量内积等于0构造平面方程；
2. 知道两个向量，求这两个向量形成的平面的方程：先求出两个向量的向量积，等于求出了法向量，然后求过原点垂直于该法向量的平面
3. 知道三个点：三个点求出两个向量，然后按2的方式求平面方程
4. 知道一个点和平面方程，求点到平面的距离：平面上一个点和已知点构成的向量，在法向量上的标量投影


### 正交子空间
设$X$和$Y$为$R^n$的子空间，若对每一$x \in X$和$y \in Y$都有$x^Ty=0$，则称子空间$X$和$Y$是正交的，记为$X \bot Y$

### 正交补
令$Y$为$R^n$的子空间，$R^n$中所有与$Y$中的每一个向量都正交的向量集合记为$Y^{\bot}$，集合$Y^{\bot}$称为Y的正交补。
$$ Y^{\bot} = {x \in R^n \vert x^Ty=0, 对每一y \in Y} $$
> 所有的向量都可以看做是从原点出发的，所以三维空间中的一维子空间的正交补就是过原点的平面，而不是平行于该平面的所有平面。

### 基本子空间
若A为一$m \times n$矩阵，则$N(A)=R(A^T)^{\bot}$，且$N(A^T) = R(A)^{\bot}$
> $R(A)$是A的值域，也是A的列空间，即由A的列向量张成的空间。$R(A^T)$是A的行向量张成的空间。

### 直和
若$U$和$V$为向量空间$W$的子空间，若对于$W$中的任一向量，都可以唯一地表示为$v+u$，其中$u \in U, v \in V$，则称W为$U, V$的直和，记作：$W = U \oplus V$
> 直和不能按期字面意思理解，不是说两个子空间构成原空间，而是原空间中的任一向量都可以写成子空间U中的一个向量和子空间V中的一个向量的线性组合。

### 正交子空间定理
若S为$R^n$中的一个子空间，则$\dim S + \dim S^{\bot} = n$；若${x_1, \cdots, x_r}$为S的一组基，${x_{r+1}, \cdots, x_n}$为$S^{\bot}$的一组基，则${x_1, \cdots, x_r, x_{r+1}, \cdots, x_n}$为$R^n$的一组基。
> 构造矩阵$\begin{bmatrix} x_1 \\\\ \vdots \\\\ x_r \end{bmatrix}$

若S为$R^n$中的一个子空间，则$R^n = S \oplus S^{\bot} ; (S^{\bot})^{\bot} = S$
> 根据上面的定理，S的有序基和其正交补空间的有序基合起来构成$R^n$的有序基，故其中的任一向量可表示为合并后的有序基的线性组合，因此可以表示为S和S的正交补空间的直和。

> S和S的正交补空间互为正交补。

若A为一$m \times n$矩阵，且$b \in R^m$，若b在A的值域中，则存在向量$x \in R^n$，使得$Ax = b$，因为$R(A) = N(A^T)^{\bot}, b \in R(A)$，所以$b \bot N(A^T)$;
若b不在A的值域中，b与$N(A^T)$不正交。

### 矩阵决定的映射
任一$m \times n$矩阵A可以看成是从$R^n \text{到} R^m$的线性变换。
$$
x \in R^n \rightarrow Ax \in R^m \\\\
\text{因为}R(A^T) = N(A)^{\bot} \\\\
x = y + z, y \in R(A^T), z \in N(A) \\\\
Ax = Ay + Az = Ay \\\\
\text{因此}R(A) = \lbrace Ax | x \in R^n \rbrace = \lbrace Ay | y \in R(A^T) \rbrace
$$
### 最小二乘法
给定一个$m \times n$的方程组$Ax = b, m > n$，因为$m>n$，所以矩阵A非满秩，A的列空间为$R^m$中的r维子空间（r是A的秩），若b不在A的列空间中，则方程没有解。但可以找到一个解x，使得$b-Ax$最小。
这里假定A的列空间是个三维空间中的二维子空间，即一个面，b刚好不在该空间中，令$p \in R(A)$，则$b - p$等于b的向量顶点到A的子空间平面的距离时，$b-Ax$最小。
> 矩阵A的列空间是$R^m$中的子空间，所以很大概率b不在A的列空间中，因此没有一个准确的解满足超定方程组，使得$Ax=b$。取$Ay=p$，p在A的列空间中，使得$b-p$最小的y为该超定方程的最小二乘解。欲使其最小，需满足
$$b-p \in S^{\bot}, S=R(A), S^{\bot} = N(A^T) \\\\
 b-p \in N(A^T), A^T(b-p) = 0, A^Tb = A^TAy$$

> 证明$b-p \in S^{\bot}, p=A\hat{x}$时，残差$r = b - Ax$有最小值
$$
令r(A) = b - y, y \in R(A)\\\\
因R(A)^{\bot} = N(A^T) \\\\
b = c + d, c \in R(A), d \in N(A^T) \\\\
r(A) = b - c + c - y = (b-c) + (c - y), \\\\
b-c=z \in N(A^T), c-y \in R(A) \\\\
||r(A)|| = \left\lVert (b-c) + (c-y) \right\rVert ^ 2 = \left\lVert (b-c)\right\rVert ^2 + \left\lVert (c-y) \right\rVert ^ 2 \\\\
|| b-y ||^2 = \left\lVert (b-c)\right\rVert ^2 + \left\lVert (c-y) \right\rVert ^ 2
$$
b, c为常量，y为变量，即当y刚好为b在R(A)中的投影时，$y=c$，残差有最小值，$b -c$。此时
$$ Ax = c, b = Ax + d, b-Ax = d \in N(A^T)$$


### 最小二乘解
若A是一**秩为n**的$m \times n$矩阵，则正规方程组$A^TAx = A^Tb$有唯一解，解为: 
$$\hat{x} = (A^TA)^{-1}A^Tb$$

> 若矩阵A的秩不是n，则超定方程的最小二乘解有无穷多个。求解的方法跟正常情况一样，不过$A^TA$不是非奇异矩阵，故没有逆。

### 最优最小二乘拟合
最优最小二乘拟合分两类：最优线性最小二乘拟合和最优n次多项式最小二乘拟合。对于最优线性最小二乘拟合，
$$
y = c_0 + c_1x \\\\
A = \begin{bmatrix} 1 & x_1 \\\\
1 & x_2 \\\\
\vdots \\\\
1 & x_n \end{bmatrix} \\\\
c = (c_0, c_1)^T \\\\
Ac = (y_1, y_2, \cdots, y_n)^T
$$
对于最优n次多项式最小二乘拟合
$$
y = c_0 + c_1x + c_2x^2 + \cdots + c_nx^n \\\\
\begin{bmatrix} 1 & x_1 & x_1^2 & \cdots & x_1^n \\\\
\vdots \\\\
1 & x_m & x_m^2 & \cdots & x_m^n \\\\ \end{bmatrix}
\begin{bmatrix} c_0 \\\\ \vdots \\\\ c_n \end{bmatrix}
= \begin{bmatrix} y_1 \\\\ \vdots \\\\ y_m \end{bmatrix}
$$
### 广义上的内积空间
> 以上我们接触到的内积又称为标量积，是定义在$R^n$空间中的；内积空间还可以定义在其他向量空间中，包括$R^{m \times n}, C[a, b], P_n$
函数向量空间有定义域，是区间；多项式向量空间的定义域为多个实数。

### 广义内积的定义
一个向量空间$V$上的内积为$V$上的运算，它将向量$x$和$y$与一个**实数**$\langle x, y \rangle$关联，并满足：
1. $\langle x, x \rangle \geqslant 0$，等号成立的充要条件是$x = 0$
2. 对$V$中的所有$x, y$，有$\langle x, y \rangle = \langle y, x \rangle$
3. 对$V$中所有的$x, y, z$及所有标量$\alpha, \beta$，有$\langle \alpha x + \beta y, z \rangle = \alpha \langle x, z \rangle + \beta \langle y, z \rangle$


> 向量空间$V$中的内积运算可以自己定义，但必须满足以上条件

### 内积空间中向量的长度
定义了内积的向量空间中的向量，其长度表示为$\left\lVert x \right\rVert = \sqrt {\langle x, x \rangle}$

### 向量空间的范数
范数是一个与内积无关的定义，是将向量空间中每一个向量$v \in V$与一个实数相关联，该实数就是范数，该运算（属性）需要满足：
1. $||v|| \geqslant 0$，其中等式成立的充要条件是$v = 0$；
2. 对任一标量$\alpha, ||\alpha v|| = |\alpha|\left\lVert v \right\rVert$
3. 对所有的$v, w \in V, ||v+w|| \leqslant ||v|| + ||w||$

> $||x|| = \sqrt {\langle x, x \rangle}$定义了一个范数，称为2范数。范数有很多，常见的如一范数，p范数，无穷范数等等。
范数跟内积的区别：范数定义的是向量本身的一个属性；内积定义的是两个向量之间的运算，即使是两个向量相等时，描述的仍然是向量之间的运算。


### 正交集
令$\lbrace v_1, v_2, \cdots, v_n \rbrace$为一内积空间$V$中的非零向量，若当$i != j, \langle v_i, v_j \rangle = 0$，则${v_1, v_2, \cdots, v_n}$称为向量的正交集；
若${v_1, v_2, \cdots, v_n}$为单位向量，则该集合称为规范正交集，亦可称为内积空间V的子空间$Span(v_1, v_2, \cdots, v_n)$中的**规范正交基**；
正交集的向量线性无关。

> 正交集要求各向量之间相互正交，但不要求正交集的向量张成原始向量空间，所以正交集不一定构成正交基

### 规范正交基的性质
令$\lbrace u_1, u_2, \cdots, u_n \rbrace$为一个内积空间$V$的规范正交基，若$v = \sum_{i=1}^n c_iu_i$，则$c_i = \langle v, u_i \rangle$
> 可以看做是将向量v用新的有序基表示出来，之前我们可以直接通过求逆的方式求出v在新的有序基中的坐标；现在规范正交基中，可以通过更简单的方式求出在各个有序基上的坐标

> 为什么可以通过内积的方式计算坐标呢？内积的定义没有固定的表示，向量空间可以随意定义内积，只要符合内积的条件。
原因在于，在确定了内积的定义之后，才有规范正交基（是否正交）

若$u = \sum_{i=1}^n a_iu_i, v = \sum_{i=1}^n b_iu_i$，则$\langle u, v \rangle = \sum_{i=1}^n a_ib_i$

### 帕塞瓦尔公式
若$\lbrace u_1, u_2, \cdots, u_n \rbrace$为一个内积空间$V$的一组规范正交基，且$ v = \sum_{i=1}^n c_iu_i$，则$ \left\lVert v \right\rVert ^2 = \sum_{i=1}^n c_i^2$

### 正交矩阵
若一个$n \times n$矩阵$Q$的列向量构成$R^n$中的一组规范正交基，则称$Q$为正交矩阵
> 正交矩阵各列向量之间正交，每一个列向量都是单位向量；正交矩阵是方阵

正交矩阵的性质：$Q^TQ=I, Q^{-1} = Q^T$
> 注意$Q, Q^T$的顺序

正交矩阵和内积：$\langle Qx, Qy \rangle = \langle x, y \rangle$

> $<Qx, Qy> = (Qy)^TQx = y^TQ^TQx = y^Tx = <x, y>$

$\left\lVert Qx \right\rVert_2 = \left\lVert x \right\rVert_2$

> 若将$Q$看做转换矩阵，上式表示用一个正交矩阵对向量进行线性转换之后，向量的长度保持不变

### 置换矩阵

单位矩阵$I$的各列重新排列获得的矩阵称为置换矩阵。置换矩阵乘以目标矩阵，目标矩阵的各行将按照置换矩阵的各行排列顺序进行排列；目标矩阵乘以置换矩阵，目标矩阵各**列**将按照置换矩阵的各列的排列顺序进行排列。

> 置换矩阵是正交矩阵，故$Q^{-1} = Q^T$

### 规范正交基和最小二乘法

令$S$为一个内积空间$V$的子空间，并令$x \in V, \lbrace u_1, u_2, \cdots, u_n \rbrace$为$S$的一组规范正交基。若$p = \sum_{i=1}^n c_iu_i,\text{其中} c_i=\langle x, u_i \rangle$,则$p - x \in S^{\bot}$

$p$称为$x$到$S$上的投影；令$U = (u_1, u_2, \cdots, u_k)$，则$b$到$S$上的投影$p = UU^Tb$；其中，$UU^T$为$b$到$R^m$子空间$S$上的投影矩阵。

> 证明：$$p = \sum_{i=1}^n \langle b, u_i \rangle u_i \\\\
> = c_1u_1 + c_2u_2 + \cdots + c_nu_n = U(c_1, \cdots, c_n)^T \\\\
> = U(u_1^Tb, u_2^Tb, \cdots, u_n^Tb)^T \\\\
> = UU^Tb  $$

要求$V$中任一向量$v$到其子空间$S$上的投影，只需构造$S$的规范正交基$U$，$ p = UU^Tv$

### 函数逼近

利用一些特殊类型的函数集合对一个连续函数进行逼近。
> 最优线性最小二乘逼近：在某个区间上定义内积运算，通过$\langle 1, x-a \rangle = 0$找出两个正交的向量，然后分别单位化，得到规范正交基$U$，然后用$U$表示目标函数在由$U$张成的子空间中的投影。此投影即为最小二乘逼近


### 三角多项式逼近
用于逼近周期函数，其内积定义一般为在$[-\pi, \pi]$上，$<f, g> = \frac{1}{\pi}\int_{-\pi}^{\pi}f(x)g(x)dx$，在该内积空间内，$\frac{1}{\sqrt{2}}, \cos x, \sin x, \cos 2x, \sin 2x, \cdots, \cos nx, \sin nx$为一个规范正交集
三角多项式的形式为
$$
t_n(x) = \frac{a_0}{2} + \sum_{k=1}^n(a_k\cos kx + b_k\sin kx) \\\\
$$

> 即将$f(x)$投影到规范正交集张成的函数向量空间中，以此最小二乘逼近原函数

其中
$$
a_k = \langle f, \cos kx \rangle = \frac{1}{\pi}\int_{-\pi}^{\pi}f(x)\cos kx dx
\\\\
b_k = \langle f, \sin kx \rangle = \frac{1}{\pi}\int_{-\pi}^{\pi}f(x)\sin kx dx
$$
对于特殊情况$a_0$，
$$
a_0 = \langle f, \cos 0x \rangle = \langle f, 1 \rangle = \sqrt{2} \langle f, \frac{1}{\sqrt{2}} \rangle 
\\\\
 \frac{a_0}{2} = \langle f, \frac{1}{\sqrt{2}} \rangle \frac{1}{\sqrt{2}}
$$
注意到当$f(x)$确定了，$a_k， b_k$也便是常数，若令
$$
r_k = \sqrt{a_k^2 + b_k^2}, \theta_k = \tan^{-1}(\frac{b_k}{a_k})
$$
则
$$
a_k\cos kx + b_k\sin kx = r_k(\frac{a_k}{r_k}\cos kx + \frac{b_k}{r_k} \sin kx) \\\\
= r_k\cos (kx - \theta)
$$
因此$t_n(x)$可以看做是简谐运动的叠加。



### 三角多项式逼近的复数形式

令
$$
c_k = \frac{1}{2}(a_k -ib_k) \\\\
= \frac{1}{2\pi}\int_{-\pi}^{\pi}f(x)(\cos kx - i\sin kx)dx \\\\
= \frac{1}{2\pi}\int_{-\pi}^{\pi}f(x)e^{-ikx}dx
$$
同时，令$c_k$的共轭$c_{-k}$为
$$
c_{-k} = \frac{1}{2}(a_k+ib_k) = \frac{1}{2\pi}\int_{-\pi}^{\pi}f(x)e^{ikx}dx
$$
因此
$$
a_k = c_k + c_{-k}, b_k = i(c_k - c_{-k}) \\\\
a_k\cos kx + b_k \sin kx = c_k\cos kx + c_{-k} \cos kx + ic_k \sin kx - ic_{-k}\sin kx \\\\
= c_k e^{ikx} + c_{-k}e^{-ikx}
$$

三角形式的复数形式表达式为
$$
t_n(x) = \sum_{k=-n}^{n}c_ke^{ikx}
$$

### 傅里叶变换
#### 抑制高频的方法

#### 离散傅里叶变换

#### 快速傅里叶变换



## 特征值

***

### 特征向量和特征值

#### 定义

令$A$为一个$n \times n$矩阵，如果存在一个非零向量$x$使得$Ax = \lambda x$，则称标量$\lambda$为特征值，向量$x$为属于$\lambda$的特征向量。

> 首先，特征值和特征向量是相对于方阵而言的，方阵对应的线性变换为线性算子，即在同一向量空间中的线性转换。特征向量的特殊之处在于，矩阵$A$乘以特征向量相当于对特征向量进行缩放，简化了矩阵乘法。所以，将向量转移成由特征向量为基的坐标表示的形式，再进行矩阵乘法，会简化运算。

#### 求解方法

$$
Ax = \lambda x \\\\
(A-\lambda I)x=0 \\\\
$$

即上式有非平凡解，等价于$A -\lambda I$为奇异的，特征多项式$p(\lambda)= det(A-\lambda I) = 0$，其中$N(A-\lambda I)$为对应于$\lambda$的特征空间（即由特征向量张成的特征空间）。

> 特别注意：对某一矩阵，特征值是唯一的（可能有重根），但每个特征向量的取值不是唯一的，而是一个一维向量，即若$x_1$是某一特征值对应的特征向量，$\alpha x_1$也是对应的特征向量

#### 性质

如果考虑重根和复数的情况，$A$刚好有n个特征值；所有特征值的和等于$A$的对角线元素之和$$\lambda _1+ \lambda _2+ \cdots + \lambda _n = trace(A) = \sum_{i=1}^{n} a_{ii}$$
所有特征值的乘积等于$A$的行列式，$det(A) = \lambda _1\cdot  \lambda _2 \cdots \lambda _n$

#### 复特征值

若矩阵为一实元素矩阵，

若$A$和$B$为有复元素的矩阵，且乘法$AB$可行，则$\overline{AB} = \overline{A} | \overline{B}$

#### 相似矩阵的特征值

若矩阵$A, B$相似，$B = S^{-1}AS$，则这两个矩阵有相同的特征多项式，相应地它们有相同的特征值。但对应于各特征值的特征向量不一样。

#### 延申的性质

1. 三角形矩阵的特征值为矩阵的对角元素

2. $A$为奇异的充要条件是：$\lambda=0$为$A$的一个特征值

3. 矩阵$A$和$A^T$具有相同的特征值（可以通过特征值之和和特征值的乘积进行证明），但对应的特征向量不一样

4. 若矩阵$Q$为一正交矩阵，则其特征值$\lambda$满足$|\lambda | = 1$
> 证明：
$$
Qx = \lambda x \\\\
(Qx)^T = \lambda x^T \\\\
(Qx)^TQx = x^Tx = \lambda x^T \lambda x = \lambda ^2 x^Tx \\\\
\lambda ^2 = 1
$$

### 对角化

#### 特征向量

若$\lambda_1, \lambda_2, \cdots, \lambda_k$为一个$n\times n$矩阵$A$的不同特征值，相应的特征向量为$x_1, \cdots, x_k$，则$x_1, \cdots, x_k$线性无关

#### 对角化

若存在一个非奇异矩阵$X$使得$A = XDX^{-1}$，其中D为对角矩阵，则称A可对角化。

$n\times n$矩阵A可对角化的充要条件是A有n个线性无关的特征向量。

> 什么时候A有n个线性无关的特征向量呢？
>
> 1. 如果A有n个不相等的特征值，则对应的n个特征向量线性无关，满足条件；
> 2. 如果A有k个不相等的特征值($k<n$)，但仍然有n个线性无关的特征向量

> 线性无关的特征向量小于n个的矩阵，称为退化的。

> 证明：如果A可对角化，即存在非奇异矩阵$X$满足$$ AX = XD \\\\ A(x_1, \cdots, x_n) = (Ax_1, \cdots, Ax_n) = (d_{11}x_1, \cdots, d_{nn}x_n) \\\\ Ax_1 = d_{11}x_1, \cdots, Ax_n = d_{nn}x_n$$
>
> 反之，如果A存在n个线性无关的特征向量，则令$X = (x_1, x_2, \cdots, x_n)$，则有$AX = XD$，其中D为对角矩阵，对角元素为特征值

矩阵对角化，D为对角矩阵，对角元素为特征值，X为特征向量构成的矩阵。对角化矩阵X不是唯一的，将X的各列重新排列，或者各列都乘以一个不等或相等的非零的标量，就可以获得一个新的对角化矩阵$X$

> $X = (x_1, x_2, \cdots, x_n)$，其中特征向量的选取不受限制，可以进行任意缩放。

证明$(c_1x_1, c_2x_2, \cdots, c_nx_n)$亦满足对角化
$$
A = XDX^{-1} \\\\
B = (c_1x_1, c_2x_2, \cdots, c_nx_n) \\\\
B = XC \\\\
BDB = XCD(XC)^{-1} = XCDC^{-1}X^{-1} \\\\
CDC^{-1} = D \\\\
BDB = A
$$

#### 几何重数和代数重数
几何重数和代数重数都是相对于矩阵A在某一特征值下而言的。
几何重数：特征值为$\lambda$时，对应的特征空间的维度；
代数重数：特征值的大小，即该特征值所对应的特征向量缩放的大小。

#### 随机矩阵

马尔科夫链

#### 矩阵指数

给定一个标量$\alpha$，指数可以表示为一个幂级数$e^{\alpha} = 1+\alpha + \frac{1}{2!}\alpha ^2 + \frac{1}{3!}\alpha ^3 + \cdots$

同理，对于任何$n\times n$矩阵A，可以定义矩阵指数为一个收敛的幂级数$e^A = I + A + \frac{1}{2!}A^2 + \frac{1}{3!}A^3+\cdots$

若A为对角矩阵, D的n次方等于将对角元素进行n次方运算，
$$
D = \lim (I+D+\frac{1}{2!}D^2 + \frac{1}{3!}D^3 + \cdots) \\\\
$$
故$e^D$为对角矩阵，对角元素为$(e^{d_1}, e^{d_2}, \cdots, e^{d_n})$。若A可对角化，
$$
A = XDX^{-1} \\\\
e^A = e^{XDX^{-1}} = I + XDX^{-1} + \frac{1}{2!}XD^2X^{-1} + \frac{1}{3!}XD3X^{-1} +\cdots \\\\
 = X(I+D + \frac{1}{2!}D^2+ \cdots)X^{-1} = Xe^DX^{-1}
$$

### 埃尔米特矩阵

#### 复数的向量空间和标量域

$C^n$表示所有n元复数组构成的向量空间，$C$表示复数集合构成的标量域。

若$a = a+bi$为一复数标量，则$a$的长度为$|a| = \sqrt{\overline{a}a} = \sqrt{a^2+b^2}$

$C^n$中的向量$z = (z_1, \cdots, z_n)^T$的长度为$||z|| = \sqrt{z^Hz}$

令$M = (m_{ij})$为一$m \times n$矩阵，且对每一个$i, j, m_{ij} = a_{ij}+ ib_{ij}$，我们可以将$M$写成$M = A + iB$，其中$M$的共轭为$\overline{M} = A - iB$。$M$的转置记为$M^H$，等于将M的所有元素先求共轭，再矩阵转置。

复数矩阵满足

1. $(A^H)^H = A$
2. $(\alpha A + \beta B)^H = \overline{\alpha}A^H + \overline{\beta}B^H$
3. $(AC)^H = C^HA^H$



#### 复内积

| $R^n$                                 | $C^n$                                      |
| ------------------------------------- | ------------------------------------------ |
| $<x, y> = y^Tx$                       | $<z, w> = w^Hz; <z,w> = \overline{<w, z>}$ |
| $x^Ty = y^Tx$                         | $z^Hw = \overline{w^Hz}$                   |
| $\left\lVert x\right\rVert ^2 = x^Tx$ | $\left\lVert z\right\rVert ^2 = z^Hz$      |



#### 埃尔米特矩阵

若一个矩阵M满足$M = M^H$，则称之为埃尔米特矩阵

> 若M为实元矩阵，则$M^H = M^T$；若M为一实对称矩阵，M为埃尔米特矩阵
>
> 埃尔米特矩阵的对角元素一定是实的。

埃尔米特矩阵的特征值都是实的，且属于不同特征值的特征向量是正交的。

> 证明：令$a = x^HAx$，因为a为复标量，故$\overline{a} = a^H = x^HAx = a$，故标量$a$是实数。因为$a = x^HAx = x^H\lambda x = \lambda ||x||^2$，所以$\lambda = \frac{a}{||x||^2}$
>
> $(Ax_1)^Hx_2 = x_1^HA^Hx_2 = x_1^HAx_2 = x_1^H\lambda _2 x_2=\lambda_2x_1^Hx_2$
>
> $(Ax_1)^Hx_2 = (x_2^HAx_1)^H = (x_2^H\lambda_1 x_1)^H = \lambda_1x_1^Hx_2$
>
> $(\lambda_1 - \lambda_2)x_1^Hx_2 = 0$

> 实对称矩阵对于不同特征值的特征向量是正交的。

#### 酉矩阵

若一个$n\times n$矩阵$U$的列向量构成了$C^n$中的一个规范正交集，则称之为酉矩阵。

> 酉矩阵满足$U^HU = I, U^H = U ^{-1}$，实的酉矩阵就是正交矩阵。

#### 舒尔定理

对每一个$n \times n$矩阵A，存在一个酉矩阵$U$，使得$U^HAU$为上三角的。$A = UTU^H$通常称为A的舒尔分解。

证明：数学归纳法证明。

首先，对于n为1的情况，满足条件。假定对于$n=k$满足条件，当$n = k+1$时，即当A为$(k+1)\times (k+1)$的矩阵时，假设A存在一个

实舒尔定理：若A是一个实的$n\times n$矩阵，则存在一个正交矩阵$Q$，使得$Q^TAQ$为上三角的。

#### 谱定理

若A为埃尔米特矩阵，则存在一个酉矩阵U对角化A。

若A为一实对称矩阵，则存在一个正交矩阵对角化A。

#### 最终定理

对任意埃尔米特矩阵A，存在一个酉矩阵U对角化它。
> 证明：根据舒尔定理，存在一个酉矩阵$U$上三角化A，$U^HAU = T$，其中T为上三角矩阵。$T^H = (U^HAU)^H = U^HA^HU = U^HAU = T$，T满足上三角矩阵，同时还是埃尔米特矩阵，故T为对角矩阵。

1. 若埃尔米特矩阵$A$的特征值互不相同，则存在一个酉矩阵$U$对角化$A$。此时求解该酉矩阵只需对每个特征向量求单位向量，$(\frac{x_1}{||x_1||^2}, \cdots, \frac{x_n}{||x_n||}^2)$即为我们要求的酉矩阵U

> 若矩阵A的特征值互不相同，则其特征向量是正交的，对每一个特征向量求单位向量，即可构成酉矩阵。

2. 若埃尔米特矩阵$A$的特征值存在重根，亦存在一个酉矩阵$U$对角化A；矩阵$U$通过求出重根对应的特征空间的规范正交基，再跟其他特征向量组合成酉矩阵U。

> 为何可以对重根的特征向量通过格拉姆-施密特方法构造规范正交基，但不能对非重根的特征向量也采用该方法构造规范正交基？
因为重根的特征空间是二维的，普通特征值的特征空间是一维的。A在特征空间内的作用是scaling，所以对重根特征值对应的特征空间，A乘以该特征空间内的任意一向量，作用都是scaling，因此在该特征空间内，求出一个规范正交基，可以替代原始的不正交的两个（或多个）特征向量。



#### 正规矩阵

满足$A^HA = AA^H$的矩阵A称为正规矩阵。A为正规矩阵的充要条件是A有一个完备的规范正交的特征向量集。

> 若A有一个完备的规范正交的特征向量集，则A可对角化为$A = UDU^H$，因为D为对角矩阵，故$DD^H = D^HD$
$$
A^HA = UD^HU^HUDU^H =UD^HDU^H \\\\
AA^H = UDU^HUD^HU^H = UDD^HU^H \\\\
AA^H = A^HA
$$

> 若$A^HA = AA^H$。首先，对于矩阵A，存在一个酉矩阵U和一个上三角矩阵，使得$A = UTU^H$，$$ T = U^HAU \\\\ T^HT = U^HA^HUU^HAU = U^HA^HAU \\\\
TT^H = U^HAUU^HA^HU = U^HAA^HU \\\\
T^HT = TT^H $$
因为T为上三角矩阵，且$TT^H$和$T^HT$相等，比较二者的对角元素可以发现，对于T矩阵，当$i\ne j, t_{ij} = 0$，即表明T为对角矩阵。因此，T不仅是上三角矩阵，而且是对角矩阵，故U对角化了A，且U的列向量为A的特征向量。从而表明，A有一个完备的规范正交的特征向量集。

埃尔米特矩阵一定是正规矩阵，因为埃尔米特矩阵有完备的规范正交的特征向量集。

#### 练习注意项

1. 令w为一复标量，则$\overline{w} = w^H$
2. 令w为一复标量，$u$为一复向量，则$wu^H = u^Hw^H = \overline{w}u^H$